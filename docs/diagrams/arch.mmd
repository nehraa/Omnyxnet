flowchart TD
    %% ========================================
    %% MACHINE CLASS DEFINITIONS - Blueprint Aesthetics
    %% ========================================
    classDef machine fill:#f9f9f9,stroke:#333,stroke-width:2px,color:#000
    classDef ingestion fill:#ffcc80,stroke:#e65100,stroke-width:2px,color:#000
    classDef security fill:#fff59d,stroke:#fbc02d,stroke-width:2px,color:#000
    classDef network fill:#e1f5fe,stroke:#0277bd,stroke-width:2px,color:#000
    classDef compute fill:#ffcdd2,stroke:#c62828,stroke-width:2px,color:#000
    classDef storage fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px,color:#000
    classDef ai fill:#f8bbd0,stroke:#ad1457,stroke-width:2px,color:#000
    classDef control fill:#b2ebf2,stroke:#00838f,stroke-width:2px,color:#000

    %% ========================================
    %% MACHINE GROUP: CLI_CONTROL_PANEL
    %% ========================================
    subgraph CLI_CONTROL["‚öôÔ∏è CLI_CONTROL_PANEL"]
        direction TB
        DESKTOP_KIVY([fa:fa-desktop Desktop App<br/>KivyMD GUI])
        DESKTOP_TK([fa:fa-window-maximize Desktop App<br/>Tkinter GUI])
        PYTHON_CLI([fa:fa-terminal Python CLI<br/>Command Interface])
        GO_MAIN([fa:fa-power-off Go Node Main<br/>Entry Point])
        RUST_MAIN([fa:fa-cogs Rust Node Main<br/>Entry Point])
    end

    %% ========================================
    %% MACHINE GROUP: INGESTION_ENGINE
    %% ========================================
    subgraph INGESTION_ENGINE["üóúÔ∏è INGESTION_ENGINE"]
        direction LR
        RUST_CES[/fa:fa-compress CES Pipeline<br/>Compression Engine\]
        RUST_CODECS[/fa:fa-file-audio Media Codecs<br/>Opus/Brotli\]
        PYTHON_PREPROCESSOR[/fa:fa-filter Data Preprocessor<br/>Input Preparation\]
    end

    %% ========================================
    %% MACHINE GROUP: SECURITY_VAULT
    %% ========================================
    subgraph SECURITY_VAULT["üîê SECURITY_VAULT"]
        direction TB
        RUST_ENCRYPTION[[fa:fa-lock XChaCha20Poly1305<br/>Encryption Chamber]]
        GO_SECURITY[[fa:fa-key Security Manager<br/>Encryption & Keys]]
        DCDN_VERIFIER[[fa:fa-certificate Signature Verifier<br/>Ed25519 Auth]]
        RUST_COMPUTE_VERIFY[[fa:fa-shield-alt Merkle Verifier<br/>Result Integrity]]
    end

    %% ========================================
    %% MACHINE GROUP: TRANSMISSION_PIPE
    %% ========================================
    subgraph TRANSMISSION_PIPE["üåê TRANSMISSION_PIPE"]
        direction TB
        GO_LIBP2P((fa:fa-project-diagram LibP2P Network<br/>NAT Traversal))
        GO_STREAMING((fa:fa-broadcast-tower Streaming Service<br/>Video/Audio/Chat))
        GO_NETWORK_ADAPTER((fa:fa-ethernet Network Adapter<br/>Multi-Protocol))
        GO_PROXY((fa:fa-user-secret SOCKS5/Tor Proxy<br/>Anonymous Routing))
        GO_DHT((fa:fa-sitemap DHT Discovery<br/>Peer Routing))
        RUST_DHT((fa:fa-globe Rust DHT<br/>Content Routing))
        DCDN_QUIC((fa:fa-tachometer-alt QUIC Transport<br/>Low-Latency UDP))
        DCDN_P2P((fa:fa-share-alt P2P Engine<br/>Mesh Network))
    end

    %% ========================================
    %% MACHINE GROUP: COMPUTE_FACTORY
    %% ========================================
    subgraph COMPUTE_FACTORY["‚öôÔ∏è COMPUTE_FACTORY"]
        direction TB
        GO_COMPUTE_MGR{{fa:fa-tasks Compute Manager<br/>Task Scheduler}}
        RUST_UPLOAD{{fa:fa-upload Upload Protocol<br/>CES + Transport}}
        RUST_DOWNLOAD{{fa:fa-download Download Protocol<br/>CES + Reconstruct}}
        RUST_COMPUTE_EXEC{{fa:fa-microchip Task Executor<br/>MapReduce}}
        RUST_COMPUTE_SANDBOX{{fa:fa-box-open WASM Sandbox<br/>Secure Execution}}
        RUST_COMPUTE_METER{{fa:fa-balance-scale Resource Metering<br/>CPU/Memory Limits}}
        DCDN_FEC{{fa:fa-recycle FEC Engine<br/>Reed-Solomon}}
        GO_ML_COORD{{fa:fa-network-wired ML Coordinator<br/>Distributed ML}}
    end

    %% ========================================
    %% MACHINE GROUP: STORAGE_FACILITY
    %% ========================================
    subgraph STORAGE_FACILITY["üóÑÔ∏è STORAGE_FACILITY"]
        direction LR
        GO_SHARED_MEM[(fa:fa-memory Shared Memory<br/>Go‚ÜîPython IPC)]
        GO_CONFIG[(fa:fa-sliders-h Config Manager<br/>Persistence)]
        GO_NODE_STORE[(fa:fa-database Node Store<br/>Peer Database)]
        RUST_CACHE[(fa:fa-hdd File Cache<br/>Manifest Store)]
        DCDN_STORAGE[(fa:fa-server Chunk Store<br/>Ring Buffer)]
    end

    %% ========================================
    %% MACHINE GROUP: AI_INTELLIGENCE_CORE
    %% ========================================
    subgraph AI_CORE["üß† AI_INTELLIGENCE_CORE"]
        direction LR
        AI_PREDICTOR{{fa:fa-brain Threat Predictor<br/>CNN Model}}
        AI_SHARD{{fa:fa-layer-group Shard Optimizer<br/>ML-based CES}}
        AI_TRANSLATION{{fa:fa-language Translation Pipeline<br/>ASR ‚Üí NMT ‚Üí TTS}}
        AI_LIPSYNC{{fa:fa-video Video Lipsync<br/>AV Sync}}
        AI_FEDERATED{{fa:fa-users-cog Federated Learning<br/>P2P-FL & CSM}}
    end

    %% ========================================
    %% INTERFACE BRIDGES
    %% ========================================
    GO_CAPNP>fa:fa-exchange-alt Cap'n Proto RPC<br/>IPC Service]
    RUST_FFI>fa:fa-random FFI Bridge<br/>Go ‚Üî Rust]
    PYTHON_GO_CLIENT>fa:fa-plug Go RPC Client<br/>Cap'n Proto]
    PYTHON_COMPUTE_CLIENT>fa:fa-laptop-code Compute Client<br/>Job Management]

    %% ========================================
    %% SERVICES - External
    %% ========================================
    SERVICE_GO_ORCH([fa:fa-server Go Orchestrator<br/>Service Entry])
    SERVICE_PYTHON_AI([fa:fa-robot Python AI Client<br/>Service Entry])
    SERVICE_RUST_COMPUTE([fa:fa-cog Rust Compute<br/>Service Entry])
    
    %% ========================================
    %% COMMUNICATION CHANNELS
    %% ========================================
    PYTHON_COMM_CHAT([fa:fa-comments Live Chat<br/>P2P Messaging])
    PYTHON_COMM_VIDEO([fa:fa-video Live Video<br/>UDP Streaming])
    PYTHON_COMM_VOICE([fa:fa-microphone Live Voice<br/>Audio Streaming])

    %% ========================================
    %% WIRING - Logic Flow
    %% ========================================

    %% Connections
    DESKTOP_KIVY --> PYTHON_GO_CLIENT
    DESKTOP_TK --> PYTHON_GO_CLIENT
    PYTHON_CLI --> PYTHON_GO_CLIENT
    PYTHON_CLI --> PYTHON_COMPUTE_CLIENT
    
    PYTHON_GO_CLIENT ==> GO_CAPNP
    PYTHON_COMPUTE_CLIENT ==> GO_CAPNP
    
    GO_MAIN ==> GO_CAPNP
    GO_MAIN --> GO_LIBP2P
    GO_MAIN --> GO_NODE_STORE
    GO_MAIN --> GO_CONFIG
    GO_MAIN --> GO_SHARED_MEM
    
    GO_CAPNP ==> RUST_FFI
    RUST_FFI ==> RUST_CES
    RUST_FFI ==> RUST_UPLOAD
    RUST_FFI ==> RUST_DOWNLOAD
    
    RUST_CES --> RUST_CODECS
    RUST_CODECS --> RUST_ENCRYPTION
    RUST_ENCRYPTION --> RUST_UPLOAD
    RUST_UPLOAD --> RUST_CACHE
    
    RUST_DOWNLOAD --> RUST_CACHE
    RUST_CACHE --> RUST_ENCRYPTION
    RUST_ENCRYPTION --> RUST_CODECS
    
    RUST_MAIN ==> DCDN_QUIC
    DCDN_QUIC --> DCDN_FEC
    DCDN_FEC --> DCDN_STORAGE
    DCDN_STORAGE <==> DCDN_P2P
    DCDN_P2P --> DCDN_VERIFIER
    
    GO_COMPUTE_MGR --> RUST_COMPUTE_EXEC
    RUST_COMPUTE_EXEC --> RUST_COMPUTE_SANDBOX
    RUST_COMPUTE_SANDBOX --> RUST_COMPUTE_METER
    RUST_COMPUTE_EXEC --> RUST_COMPUTE_VERIFY
    
    GO_LIBP2P <==> GO_NETWORK_ADAPTER
    GO_NETWORK_ADAPTER <==> GO_PROXY
    GO_LIBP2P --> GO_DHT
    GO_SECURITY --> GO_CAPNP
    GO_STREAMING --> GO_LIBP2P
    
    PYTHON_GO_CLIENT -.-> AI_PREDICTOR
    PYTHON_GO_CLIENT -.-> AI_SHARD
    PYTHON_PREPROCESSOR --> AI_TRANSLATION
    AI_TRANSLATION --> AI_LIPSYNC
    AI_FEDERATED --> GO_ML_COORD
    GO_ML_COORD --> GO_COMPUTE_MGR
    
    PYTHON_CLI --> PYTHON_COMM_CHAT
    PYTHON_CLI --> PYTHON_COMM_VIDEO
    PYTHON_CLI --> PYTHON_COMM_VOICE
    PYTHON_COMM_CHAT --> GO_STREAMING
    PYTHON_COMM_VIDEO --> GO_STREAMING
    PYTHON_COMM_VOICE --> GO_STREAMING
    
    SERVICE_GO_ORCH --> GO_CAPNP
    SERVICE_PYTHON_AI --> PYTHON_GO_CLIENT
    SERVICE_RUST_COMPUTE --> RUST_COMPUTE_EXEC
    
    RUST_UPLOAD --> GO_NETWORK_ADAPTER
    GO_LIBP2P <==> DCDN_P2P
    
    RUST_DHT --> RUST_CACHE
    GO_DHT --> GO_NODE_STORE
    PYTHON_PREPROCESSOR --> RUST_CES
    
    %% Future Links
    RUST_DHT -.-> DCDN_P2P
    AI_SHARD -.-> RUST_CES
    GO_PROXY -.-> GO_NETWORK_ADAPTER

    %% ========================================
    %% APPLY STYLING
    %% ========================================
    class DESKTOP_KIVY,DESKTOP_TK,PYTHON_CLI,GO_MAIN,RUST_MAIN,SERVICE_GO_ORCH,SERVICE_PYTHON_AI,SERVICE_RUST_COMPUTE control
    class RUST_CES,RUST_CODECS,PYTHON_PREPROCESSOR ingestion
    class RUST_ENCRYPTION,GO_SECURITY,DCDN_VERIFIER,RUST_COMPUTE_VERIFY security
    class GO_LIBP2P,GO_STREAMING,GO_NETWORK_ADAPTER,GO_PROXY,GO_DHT,RUST_DHT,DCDN_QUIC,DCDN_P2P,PYTHON_COMM_CHAT,PYTHON_COMM_VIDEO,PYTHON_COMM_VOICE network
    class GO_COMPUTE_MGR,RUST_UPLOAD,RUST_DOWNLOAD,RUST_COMPUTE_EXEC,RUST_COMPUTE_SANDBOX,RUST_COMPUTE_METER,DCDN_FEC,GO_ML_COORD compute
    class GO_SHARED_MEM,GO_CONFIG,GO_NODE_STORE,RUST_CACHE,DCDN_STORAGE storage
    class AI_PREDICTOR,AI_SHARD,AI_TRANSLATION,AI_LIPSYNC,AI_FEDERATED ai
    class GO_CAPNP,RUST_FFI,PYTHON_GO_CLIENT,PYTHON_COMPUTE_CLIENT network

    %% ========================================
    %% INTERACTIVITY
    %% ========================================
    click DESKTOP_KIVY "./desktop_app_kivy.py#L1"
    click DESKTOP_TK "./desktop_app.py#L1"
    click PYTHON_CLI "./python/main.py#L1"
    click GO_MAIN "./go/main.go#L16"
    click RUST_MAIN "./rust/src/main.rs#L1"
    click AI_PREDICTOR "./python/src/ai/predictor.py#L1"
    click AI_SHARD "./python/src/ai/shard_optimizer.py#L1"
    click AI_TRANSLATION "./python/src/ai/translation_pipeline.py#L1"
    click AI_LIPSYNC "./python/src/ai/video_lipsync.py#L1"
    click AI_FEDERATED "./python/src/ai/federated_learning.py#L1"
    click GO_CAPNP "./go/capnp_service.go#L1"
    click GO_LIBP2P "./go/libp2p_node.go#L1"
    click GO_SECURITY "./go/security.go#L1"
    click GO_STREAMING "./go/streaming.go#L1"
    click GO_COMPUTE_MGR "./go/pkg/compute/manager.go#L1"
    click GO_SHARED_MEM "./go/shared_memory.go#L1"
    click GO_CONFIG "./go/config.go#L1"
    click GO_ML_COORD "./go/ml_coordinator.go#L1"
    click GO_PROXY "./go/security.go#L1"
    click GO_NETWORK_ADAPTER "./go/network_adapter.go#L1"
    click GO_DHT "./go/libp2p_node.go#L1"
    click GO_NODE_STORE "./go/types.go#L1"
    click RUST_CES "./rust/src/ces.rs#L21"
    click RUST_ENCRYPTION "./rust/src/ces.rs#L4"
    click RUST_CODECS "./rust/src/codecs.rs#L1"
    click RUST_UPLOAD "./rust/src/upload.rs#L1"
    click RUST_DOWNLOAD "./rust/src/download.rs#L1"
    click RUST_FFI "./rust/src/ffi.rs#L1"
    click RUST_CACHE "./rust/src/cache.rs#L1"
    click RUST_DHT "./rust/src/dht.rs#L1"
    click DCDN_QUIC "./rust/src/dcdn/transport.rs#L1"
    click DCDN_FEC "./rust/src/dcdn/fec.rs#L1"
    click DCDN_P2P "./rust/src/dcdn/p2p.rs#L1"
    click DCDN_STORAGE "./rust/src/dcdn/storage.rs#L1"
    click DCDN_VERIFIER "./rust/src/dcdn/verifier.rs#L1"
    click RUST_COMPUTE_SANDBOX "./rust/src/compute/sandbox.rs#L1"
    click RUST_COMPUTE_EXEC "./rust/src/compute/executor.rs#L1"
    click RUST_COMPUTE_VERIFY "./rust/src/compute/verification.rs#L1"
    click RUST_COMPUTE_METER "./rust/src/compute/metering.rs#L1"
    click PYTHON_GO_CLIENT "./python/src/client/go_client.py#L1"
    click PYTHON_COMPUTE_CLIENT "./python/src/compute/client.py#L1"
    click PYTHON_PREPROCESSOR "./python/src/compute/preprocessor.py#L1"
    click PYTHON_COMM_CHAT "./python/src/communication/live_chat.py#L1"
    click PYTHON_COMM_VIDEO "./python/src/communication/live_video.py#L1"
    click PYTHON_COMM_VOICE "./python/src/communication/live_voice.py#L1"
    click SERVICE_GO_ORCH "./services/go-orchestrator/main.go#L1"
    click SERVICE_PYTHON_AI "./services/python-ai-client/app/main.py#L1"
    click SERVICE_RUST_COMPUTE "./services/rust-compute/src/main.rs#L1"
